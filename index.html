<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Embed ThoughtSpot Liveboard</title>
</head>
<body>
    <div id="ts-embed" style="width: 100%; height: 600px;"></div>
    <div id="loader" style="display:none;">Loading...</div>
    <div id="no-data" style="display:none;">No Data Available</div>
    <script type="module">
        import {
          init,
          LiveboardEmbed,
          EmbedEvent,
          AuthType
        } from "https://cdn.jsdelivr.net/npm/@thoughtspot/visual-embed-sdk/dist/tsembed.es.js";

        // Function to fetch the authentication token
        async function getTokenService() {
          // Fetch the token from a server endpoint or any other method
          const response = await fetch('/get-token');
          const token = await response.text();
          return token;
        }

        // Initialize ThoughtSpot Embed SDK
        init({
          thoughtSpotHost: "https://team3.thoughtspot.cloud",
          authType: AuthType.TrustedAuthTokenCookieless,
          getAuthToken: getTokenService,
          disableTokenVerification: true,
        });

        // Embed the Liveboard
        const embed = new LiveboardEmbed("#ts-embed", {
          frameParams: {
            width: "100%",
            height: "100%"
          },
          liveboardId: "b6bb40a3-57dc-4b46-bfdc-9d76fbb74491",
          vizId: "d4b5a4a1-506e-46f8-907e-f39b658b4d11",
        });

        hideNoDataImage();

        embed
          .on(EmbedEvent.Init, showLoader)
          .on(EmbedEvent.Load, hideLoader)
          .on(EmbedEvent.Error, () => {
            showNoDataImage();
            hideLoader();
          })
          .render();

        function setDisplayStyle(el, style) {
          if (document.getElementById(el)) {
            document.getElementById(el).style.display = style;
          }
        }

        function showLoader() {
          setDisplayStyle("loader", "block");
        }

        function hideLoader() {
          setDisplayStyle("loader", "none");
        }

        function showNoDataImage() {
          setDisplayStyle("no-data", "block");
        }

        function hideNoDataImage() {
          setDisplayStyle("no-data", "none");
        }
    </script>
</body>
</html>
